import { BezierTool, ToolMode } from './BezierTool.js';
import { PointArrayInputHandler, PointInputHandler, InitializerInputHandler } from "./ToolInputHandler.js";
const pointNearPoint = BezierTool.pointNearPoint;
class InitializerIH extends InitializerInputHandler {
	constructor(tool, success, fail) {
		super(tool.lineA, tool.lineB, success, fail);
		this.tool = tool;
	}
	move(origin, destination, event) {
		super.move(origin, destination, event);
		var dx = this.tool.lineB.x - this.tool.lineA.x;
		var dy = this.tool.lineB.y - this.tool.lineA.y;
		const length = Math.sqrt((dx * dx) + (dy * dy));
		dx *= 0.5;
		dy *= 0.5;
		this.tool.control.set(this.tool.lineA.x + dx + dy, this.tool.lineA.y + dy - dx);
	}
}
export default class QuadTool extends BezierTool {
	constructor() {
		super(...arguments);
		this.lineA = new PIXI.Point();
		this.lineB = new PIXI.Point();
		this.control = new PIXI.Point();
	}
	get handles() { return [this.lineA, this.control, this.lineB]; }
	get bounds() {
		const b = new PIXI.Bounds();
		b.addPoint(this.lineA);
		b.addPoint(this.lineB);
		b.addPoint(this.control);
		return b;
	}
	get polygon() { return new PIXI.Polygon([this.lineA, this.lineB, this.control]); }
	initialPoints() { return [0, 0, 0, 0, 0, 0]; }
	drawHandles(context) {
		if (this.mode == ToolMode.NotPlaced)
			return;
		this.drawBoundingBox(context);
		context.beginFill(0xffaacc)
			.lineStyle(BezierTool.LINE_SIZE, 0xffaacc, 1, 0.5)
			.moveTo(this.lineA.x, this.lineA.y)
			.lineTo(this.control.x, this.control.y)
			.moveTo(this.lineB.x, this.lineB.y)
			.lineTo(this.control.x, this.control.y)
			.endFill();
		super.drawSegmentLabel(context);
		this.drawHandle(context, 0xff4444, this.lineA);
		this.drawHandle(context, 0xff4444, this.lineB);
		this.drawHandle(context, 0xaaff44, this.control);
	}
	checkPointForDrag(point) {
		if (this.mode == ToolMode.NotPlaced) {
			this.setMode(ToolMode.Placing);
			return new InitializerIH(this, () => this.setMode(ToolMode.Placed), () => this.setMode(ToolMode.NotPlaced));
		}
		if (pointNearPoint(point, this.lineA, BezierTool.HANDLE_RADIUS))
			return new PointInputHandler(this.lineA);
		else if (pointNearPoint(point, this.lineB, BezierTool.HANDLE_RADIUS))
			return new PointInputHandler(this.lineB);
		else if (pointNearPoint(point, this.control, BezierTool.HANDLE_RADIUS))
			return new PointInputHandler(this.control);
		else if (this.polygon.contains(point.x, point.y))
			return new PointArrayInputHandler(point, this.handles);
		return null;
	}
	getTools() { return []; }
	showTools() { }
	hideTools() { }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2RmLWN1cnZ5LXdhbGxzL3NyYy90b29scy9RdWFkVG9vbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRXZELE9BQU8sRUFBRSxzQkFBc0IsRUFBZ0IsaUJBQWlCLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUV6SCxNQUFNLGNBQWMsR0FBRyxVQUFVLENBQUMsY0FBYyxDQUFDO0FBR2pELE1BQU0sYUFBYyxTQUFRLHVCQUF1QjtJQUVsRCxZQUFZLElBQWMsRUFBRSxPQUFtQixFQUFFLElBQWdCO1FBQ2hFLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFBO1FBQzVDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ2xCLENBQUM7SUFDRCxJQUFJLENBQUMsTUFBYSxFQUFFLFdBQWtCLEVBQUUsS0FBNEI7UUFDbkUsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ3ZDLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDL0MsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUMvQyxNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDaEQsRUFBRSxJQUFJLEdBQUcsQ0FBQztRQUNWLEVBQUUsSUFB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ZixTQUFTLEtBQUssQ0FBQztDQUNmIiwiZmlsZSI6InRvb2xzL1F1YWRUb29sLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgeyBCZXppZXJUb29sLCBUb29sTW9kZSB9IGZyb20gJy4vQmV6aWVyVG9vbC5qcyc7XG5pbXBvcnQgeyBUb29sVUkgfSBmcm9tICcuLi9CZXppZXJUb29sQmFyLmpzJztcbmltcG9ydCB7IFBvaW50QXJyYXlJbnB1dEhhbmRsZXIsIElucHV0SGFuZGxlciwgUG9pbnRJbnB1dEhhbmRsZXIsIEluaXRpYWxpemVySW5wdXRIYW5kbGVyIH0gZnJvbSBcIi4vVG9vbElucHV0SGFuZGxlci5qc1wiO1xuXG5jb25zdCBwb2ludE5lYXJQb2ludCA9IEJlemllclRvb2wucG9pbnROZWFyUG9pbnQ7XG5kZWNsYXJlIHR5cGUgUG9pbnQgPSBQSVhJLlBvaW50O1xuXG5jbGFzcyBJbml0aWFsaXplcklIIGV4dGVuZHMgSW5pdGlhbGl6ZXJJbnB1dEhhbmRsZXIge1xuXHRwcml2YXRlIHRvb2w6IFF1YWRUb29sO1xuXHRjb25zdHJ1Y3Rvcih0b29sOiBRdWFkVG9vbCwgc3VjY2VzczogKCkgPT4gdm9pZCwgZmFpbDogKCkgPT4gdm9pZCkge1xuXHRcdHN1cGVyKHRvb2wubGluZUEsIHRvb2wubGluZUIsIHN1Y2Nlc3MsIGZhaWwpXG5cdFx0dGhpcy50b29sID0gdG9vbDtcblx0fVxuXHRtb3ZlKG9yaWdpbjogUG9pbnQsIGRlc3RpbmF0aW9uOiBQb2ludCwgZXZlbnQ6IFBJWEkuSW50ZXJhY3Rpb25FdmVudCk6IHZvaWQge1xuXHRcdHN1cGVyLm1vdmUob3JpZ2luLCBkZXN0aW5hdGlvbiwgZXZlbnQpO1xuXHRcdHZhciBkeCA9IHRoaXMudG9vbC5saW5lQi54IC0gdGhpcy50b29sLmxpbmVBLng7XG5cdFx0dmFyIGR5ID0gdGhpcy50b29sLmxpbmVCLnkgLSB0aGlzLnRvb2wubGluZUEueTtcblx0XHRjb25zdCBsZW5ndGggPSBNYXRoLnNxcnQoKGR4ICogZHgpICsgKGR5ICogZHkpKTtcblx0XHRkeCAqPSAwLjU7XG5cdFx0ZHkgKj0gMC41O1xuXHRcdHRoaXMudG9vbC5jb250cm9sLnNldCh0aGlzLnRvb2wubGluZUEueCArIGR4ICsgZHksIHRoaXMudG9vbC5saW5lQS55ICsgZHkgLSBkeCk7XG5cdH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUXVhZFRvb2wgZXh0ZW5kcyBCZXppZXJUb29sIHtcblx0bGluZUEgPSBuZXcgUElYSS5Qb2ludCgpO1xuXHRsaW5lQiA9IG5ldyBQSVhJLlBvaW50KCk7XG5cdGNvbnRyb2wgPSBuZXcgUElYSS5Qb2ludCgpO1xuXG5cdGdldCBoYW5kbGVzKCk6IFBvaW50W10geyByZXR1cm4gW3RoaXMubGluZUEsIHRoaXMuY29udHJvbCwgdGhpcy5saW5lQl07IH1cblx0Z2V0IGJvdW5kcygpOiBQSVhJLkJvdW5kcyB7XG5cdFx0Y29uc3QgYiA9IG5ldyBQSVhJLkJvdW5kcygpO1xuXHRcdGIuYWRkUG9pbnQodGhpcy5saW5lQSk7XG5cdFx0Yi5hZGRQb2ludCh0aGlzLmxpbmVCKTtcblx0XHRiLmFkZFBvaW50KHRoaXMuY29udHJvbCk7XG5cdFx0cmV0dXJuIGI7XG5cdH1cblx0Z2V0IHBvbHlnb24oKTogUElYSS5Qb2x5Z29uIHsgcmV0dXJuIG5ldyBQSVhJLlBvbHlnb24oW3RoaXMubGluZUEsIHRoaXMubGluZUIsIHRoaXMuY29udHJvbF0pOyB9XG5cblx0aW5pdGlhbFBvaW50cygpOiBudW1iZXJbXSB7IHJldHVybiBbMCwgMCwgMCwgMCwgMCwgMF07IH1cblx0ZHJhd0hhbmRsZXMoY29udGV4dDogUElYSS5HcmFwaGljcyk6IHZvaWQge1xuXHRcdGlmICh0aGlzLm1vZGUgPT0gVG9vbE1vZGUuTm90UGxhY2VkKSByZXR1cm47XG5cdFx0dGhpcy5kcmF3Qm91bmRpbmdCb3goY29udGV4dCk7XG5cdFx0Y29udGV4dC5iZWdpbkZpbGwoMHhmZmFhY2MpXG5cdFx0XHQubGluZVN0eWxlKEJlemllclRvb2wuTElORV9TSVpFLCAweGZmYWFjYywgMSwgMC41KVxuXHRcdFx0Lm1vdmVUbyh0aGlzLmxpbmVBLngsIHRoaXMubGluZUEueSlcblx0XHRcdC5saW5lVG8odGhpcy5jb250cm9sLngsIHRoaXMuY29udHJvbC55KVxuXHRcdFx0Lm1vdmVUbyh0aGlzLmxpbmVCLngsIHRoaXMubGluZUIueSlcblx0XHRcdC5saW5lVG8odGhpcy5jb250cm9sLngsIHRoaXMuY29udHJvbC55KVxuXHRcdFx0LmVuZEZpbGwoKTtcblx0XHRzdXBlci5kcmF3U2VnbWVudExhYmVsKGNvbnRleHQpO1xuXHRcdHRoaXMuZHJhd0hhbmRsZShjb250ZXh0LCAweGZmNDQ0NCwgdGhpcy5saW5lQSk7XG5cdFx0dGhpcy5kcmF3SGFuZGxlKGNvbnRleHQsIDB4ZmY0NDQ0LCB0aGlzLmxpbmVCKTtcblx0XHR0aGlzLmRyYXdIYW5kbGUoY29udGV4dCwgMHhhYWZmNDQsIHRoaXMuY29udHJvbCk7XG5cdH1cblx0Y2hlY2tQb2ludEZvckRyYWcocG9pbnQ6IFBvaW50KTogSW5wdXRIYW5kbGVyIHwgbnVsbCB7XG5cdFx0aWYgKHRoaXMubW9kZSA9PSBUb29sTW9kZS5Ob3RQbGFjZWQpIHtcblx0XHRcdHRoaXMuc2V0TW9kZShUb29sTW9kZS5QbGFjaW5nKTtcblx0XHRcdHJldHVybiBuZXcgSW5pdGlhbGl6ZXJJSCh0aGlzLCAoKSA9PiB0aGlzLnNldE1vZGUoVG9vbE1vZGUuUGxhY2VkKSwgKCkgPT4gdGhpcy5zZXRNb2RlKFRvb2xNb2RlLk5vdFBsYWNlZCkpO1xuXHRcdH1cblx0XHRpZiAocG9pbnROZWFyUG9pbnQocG9pbnQsIHRoaXMubGluZUEsIEJlemllclRvb2wuSEFORExFX1JBRElVUykpXG5cdFx0XHRyZXR1cm4gbmV3IFBvaW50SW5wdXRIYW5kbGVyKHRoaXMubGluZUEpO1xuXHRcdGVsc2UgaWYgKHBvaW50TmVhclBvaW50KHBvaW50LCB0aGlzLmxpbmVCLCBCZXppZXJUb29sLkhBTkRMRV9SQURJVVMpKVxuXHRcdFx0cmV0dXJuIG5ldyBQb2ludElucHV0SGFuZGxlcih0aGlzLmxpbmVCKTtcblx0XHRlbHNlIGlmIChwb2ludE5lYXJQb2ludChwb2ludCwgdGhpcy5jb250cm9sLCBCZXppZXJUb29sLkhBTkRMRV9SQURJVVMpKVxuXHRcdFx0cmV0dXJuIG5ldyBQb2ludElucHV0SGFuZGxlcih0aGlzLmNvbnRyb2wpO1xuXHRcdGVsc2UgaWYgKHRoaXMucG9seWdvbi5jb250YWlucyhwb2ludC54LCBwb2ludC55KSlcblx0XHRcdHJldHVybiBuZXcgUG9pbnRBcnJheUlucHV0SGFuZGxlcihwb2ludCwgdGhpcy5oYW5kbGVzKTtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXG5cdGdldFRvb2xzKCk6IFRvb2xVSVtdIHsgcmV0dXJuIFtdOyB9XG5cdHNob3dUb29scygpIHsgfVxuXHRoaWRlVG9vbHMoKSB7IH1cbn0iXX0=
